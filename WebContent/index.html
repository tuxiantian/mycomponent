<!doctype html>
<html>
 <head> 
  <meta charset="UTF-8"> 
  <title>我的前端组件库</title>
  <meta name="keywords" content="首页2"> 
  <link rel="stylesheet" href="${webSiteDomain}/mycomponent/lib/pagination/1.2.1/pagination.css" />
  <style type="text/css">
*{padding: 0;margin: 0;}
a{text-decoration: none;}
body{font-size: 12px;font-family: "微软雅黑";}
/* start 页面头部样式 */
.header{height: 50px;background: #999;position: relative;top:0;}
.header span{height: 50px;line-height: 50px;padding-left: 50px;width: 180px;font-size: 20px;
    font-weight: bold;float: left;}
.header input{float: left;display: inline-block;height:25px; line-height: 25px;margin-top: 10px; }
.header .wd{width: 250px;outline: none;margin-left: 350px;padding-left: 10px;}
.header .search{width: 60px;height: 29px;}
/* 页面头部样式 end */


/* start 左侧菜单栏样式 */
.sliderbox{width: 0;height: 100%;position: absolute;top:0;left:0;display: none;background: #ccc;overflow: scroll;}
.sliderbox ul{display: block; margin-left: 10px;padding-left: 10px;}
.sliderboxul li {list-style: none;display: list-item;}
.sliderbox ul li a{text-decoration: none;width: 200px;height: 25px;line-height: 25px;display: block;}
/* 左侧菜单栏样式 end */
.mainbox{margin-left: 0;height: 100%;background-color:#f0f0f0;}
iframe {width: 99%;height: 580px;}
.contentbox{width: 985px;margin: 10px auto;}
/* start 搜索结果样式 */
#result{height:91%;width: 99%;margin:0 auto; } 
.record{border: 1px solid red;margin: 20px 0;}
.record p{margin: 10px 10px;font-size: 16px;}
/* 搜索结果样式 end */
/*start 返回顶部的样式 */
.to-top.visible {
    -webkit-transition: opacity .3s 0s, visibility 0s 0s;
    -moz-transition: opacity .3s 0s, visibility 0s 0s;
    transition: opacity .3s 0s, visibility 0s 0s;
    visibility: visible;
    opacity: 1;
}
.to-top {
    display: inline-block;
    height: 40px;
    width: 40px;
    position: fixed;
    bottom: 75px;
    right: 40px;
    border-radius: 50%;
    box-shadow: 0 0 10px rgba(0,0,0,.05);
    overflow: hidden;
    text-indent: 100%;
    white-space: nowrap;
    background: #5b4782 url(${webSiteDomain}/mycomponent/demo/css/images/to-top-arrow.svg) no-repeat center 50%;
    visibility: hidden;
    opacity: 0;
    -webkit-transition: opacity .3s 0s, visibility 0s .3s;
    -moz-transition: opacity .3s 0s, visibility 0s .3s;
    transition: opacity .3s 0s, visibility 0s .3s;
}
/* 返回顶部的样式  end*/
</style> 
  <script type="text/javascript" src="${webSiteDomain}/mycomponent/lib/jQuery/jquery-1.11.3.js"></script> 
 <script type="text/javascript" src="${webSiteDomain}/mycomponent/lib/js/menu.js"></script>
 </head> 
 <body> 
  <div class="sliderbox"> 
  <ul>
  			<!-- start 常用的外部组件 -->
			<li>常用的外部组件
			<#include "index/component.tpl">
			</li>
			<!-- 常用的外部组件 end -->
			<!-- start 有用的网址 -->
			<li>有用的网址
			<#include "index/useful.tpl">
			</li>
			<!-- 有用的网址 end-->
			<!-- satrt 工具 -->
			<li>工具
			<#include "index/tool.tpl">
			</li>
			<!-- 工具 end-->
			<!-- start 知识 -->
			<li>知识
			<#include "index/knowledge.tpl">
			</li>
			<!-- 知识 end -->
			<!-- start project -->
			<li>project
			<#include "index/project.tpl">
			</li>
			<!-- end project -->
			<!-- start css3 -->
			<li>css3
			<#include "index/css3.tpl">
			</li>
			<!-- end css3 -->
			<!-- start css -->
			<li>css
			<#include "index/css.tpl">
			</li>
			<!-- end css -->
			<!-- start test -->
			<li>test
			<#include "index/test.tpl">
			</li>
			<!-- end test -->
			<!-- start html5 -->
			<li>html5
				<#include "index/html5.tpl">
			</li>
			<!-- end html5 -->
			<!-- start document -->
			<li>document
			<#include "index/document.tpl">
			</li>
			<!-- end document -->
		</ul>
  </div> 
  <div class="mainbox" id="mainbox"> 
   <div class="header"><span class="expand">我的前端组件库</span>
   <input type="text" id="wd" name="wd" list="wd_list" class="wd"><input type="button" class="search" id="search" value="搜索">
  &nbsp;&nbsp;<input  type="button" id="back" value="返回" class="search">
  <datalist id="wd_list">
  <option value="demo">
  </datalist>
   </div> 
   <div id="result"></div>
   <div id="page" class="pagination"> </div>
   <div class="contentbox" id="contentbox"> 
    <iframe name="main" id="iframepage" marginheight="0"  marginwidth="0" frameborder="0" scrolling-x="no" scrolling-y="yes"></iframe>
    	
   </div> 
  </div> 
  <a href="javascript:scroll(0,0)" class="to-top visible">Top</a>
 <script type="text/javascript" src="${webSiteDomain}/mycomponent/lib/js/page.js"></script>
  <script type="text/javascript">	
$(function() {
	
	/* 搜索框的初始化 */
	 function search_init(){
		  var wd_list=[];
		  if(localStorage.getItem("wd_list")==null){
			  localStorage.wd_list=wd_list;
		  }
		  else{
			  wd_list=localStorage.wd_list.split(",");
			  var html,length=wd_list.length;
			  for(var i=0;i<length;i++){
				  html="<option label='Microsoft' value='"+wd_list[i]+"'>";
					$("#wd_list").prepend(html); 
			  } 
		  }
	  }
	  search_init();
	  /* 搜索框的下拉列表 */
		function search_list(wd){
	  	var wd_list=new Array();
		wd_list=localStorage.wd_list.split(",");
		
		$("#wd_list").find("option").each(function(index,element){
			if($.inArray(wd,wd_list)==-1){
				var html="<option label='' value='"+wd+"'>";
				$("#wd_list").prepend(html);
				wd_list.push(wd);
				localStorage.wd_list=wd_list;
				return;
			}
		}); 
	}
	//初始化菜单
	initmenu();
	/* 当iframepage中的文档高度大于600时，显示返回顶部；否则，不显示。 */
	 $("#iframepage").load(function() {
		 var ifm= document.getElementById("iframepage");   
		 var subWeb = document.frames ? document.frames["iframepage"].document : ifm.contentDocument;   
		 if(ifm != null && subWeb != null) { 
			 if(subWeb.body.scrollHeight>600||ifm.height>600){
				 $(".to-top").show();
		 		  
			 }else{
				 $(".to-top").hide();
			 }
		 }   
	}); 
	
	//左侧菜单栏的显示与隐藏控制
	$(".expand").on("click",function(){
		var w=$(".sliderbox").width();
		//隐藏
		if(w==280){
			$(".sliderbox").show().animate({width:0},200,function(){
				$(this).hide();
			});
			$(".mainbox").animate({float:"none",marginLeft:0},200);
			$("#result").animate({left:0},200);
			$("body,html").css("overflow","auto");
			$("#contentbox").css({"margin":"10px auto"});
		}//展开
		else{
			$(".sliderbox").show().animate({width:280},200);
			$(".mainbox").animate({float:"left",marginLeft:280},200);
			$("#result").animate({left:280},200);
			$("body,html").css({"overflow-x":"hidden","overflow-y":"auto"});
			$("#contentbox").css({"margin":"10px 0 0 10px"});
		}
	});
	//默认左侧菜单展开
	$(".expand").trigger("click");
	//回到文档顶部
	$(".to-top").click(function() {
		var iframe = document.getElementById("iframepage");
		iframe.contentWindow.window.scrollTo(0,0);
		$("#result").animate({scrollTop:0},200);
	});
	//点击侧边栏的a标签时，隐藏搜索结果，显示网页内容
	$(".sliderbox ul li a").click(function() {
		$("#result").hide();
		$("#contentbox").show();
		$("#page").hide();
	});
	//输入完成，回车搜索
	$("#wd").keydown(function(evt){ 
		var event = evt || window.event;
		var keyCode = event.keyCode;
		if (keyCode == '13'){
			$("#search").trigger("click");
		}
		
	});//回车搜索 end
	$("#search").click(function(){
		var wd=$("#wd").val().trim();
		if(wd==""){
			alert("请输入关键词！");
			return;
		}
		search_list(wd);
		
		//点击搜索时，显示搜索结果，隐藏具体内容。
		$("#result").show();
		$("#contentbox").hide();
		 $(".to-top").hide();
		var url="${webSiteDomain}/lucene_demo/QueryIndex";
		var datas="wd="+$("#wd").val();
		/* 调用ajax开始 */
		$.ajax({
	        url: url,
	        type: "POST",
	        data : datas +"&_=" + (new Date()).getTime(),
	        cache: false,
	        dataType: "json",
	        timeout: 60000,
			beforeSend: function (xhr) {
			    xhr.overrideMimeType("text/plain; charset=utf-8");
			},
	        success: function(json) {
		        	if(json!=null){
		        	var html="";
		        	$.each(json,function(i,obj){
		        		if(obj!=null){
		        		html+="<div class='record'>";
		        		html+="<p><strong>标题:</strong>"+obj.title+"</p>";
		        		html+="<p><strong>关键字:</strong>"+obj.keywords+"</p>";
		        		html+="<p><strong>URL:</strong><a target='main' href='"+obj.url+"'>"+obj.url+"</a></p>";
		        		html+="</div>";
		        		}
		        	});//each end
	        	
	        		$("#result").html(html);
		        	//显示结果的同时进行分页
	        		Page.prototype.initPage();
	        		
		        	$(".record a").unbind('click').bind('click', function(){
		        		$("#result").hide();
		        		$("#contentbox").show();
		        		$("#page").hide();
		        	});
		        	$("#back").unbind('click').bind('click', function(){
		        		$("#result").show();
		        		$("#contentbox").hide();
		        		$("#page").show();
		        		 $(".to-top").hide();
		        	});
		        	
	        	}
	        }
		});//ajax end
		
	});//search end
});
</script>  
 

 </body>
</html>